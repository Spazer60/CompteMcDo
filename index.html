<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style> /* styles responsive pro (Ã  adapter) */ </style>
</head>
<body>
  <div id="grid"></div>

  <script>
    // callback JSONP: Google Apps Script renverra handleData([...])
    window.handleData = function(data) {
      var grid = document.getElementById('grid');
      grid.innerHTML = '';
      data.forEach(function(item){
        var btn = `<button onclick="showQR('${item.compte.replace(/\s+/g,'')}')">Voir QR</button>`;
        var html = '<div class="card"><div><strong>' + item.compte + '</strong><br>' + item.points + ' pts</div>' + btn + '</div>';
        grid.innerHTML += html;
      });
    };

    // injecter la balise script pour charger la JSONP
    (function(){
      var s = document.createElement('script');
      s.src = 'https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLjswVAcSC6KR0d59GOOGPPq6gnGT6RksLOU3zrk50ErGNPre2enOb8M1Rfs8iOvmUQKaCiEy5drlaaohzRC9ULftRhP-fh7O4sKBhO9spQaSRrnQddvGmvYJAIIQU2C-sd7er0nppLG8cW0V4axok0EEc1ZhUYtv_hMcbu9iVwdvHuZLb9P40D8j7yrUKt_WHQzcJS4HClxe5d40E9FGqRkVq9ZeB4AlG2DEOudx3lbpnsqllQOzu-4falimF4hc84x2OME6PRpNw_rgo3p1SnGBcerYja01pqk77l2&lib=MxVXXZlqIH364iH36jsqo-CGQnR1GVltq?callback=handleData';
      document.body.appendChild(s);
    })();

    function showQR(id) {
      window.open('https://api.qrserver.com/v1/create-qr-code/?data=' + encodeURIComponent(id) + '&size=800x800', '_blank');
    }
  </script>
</body>
</html>
